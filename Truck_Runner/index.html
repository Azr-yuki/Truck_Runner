<!DOCTYPE html>
<html lang="en">
<head>
<!-- UTF-8 ensures emoji + special characters render correctly -->
<meta charset="UTF-8" />
<!-- Responsive viewport keeps layout consistent on phones/tablets -->
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Browser tab label -->
<title>Truck Runner</title>

<!-- Load all layout + animation rules for the runner scene -->
<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- Page body is split into HUD overlays + the animated runner viewport -->

<!-- ===============================
     AUTH / USER INTERFACE
     =============================== -->
<!-- Floating HUD that handles sign-in status, user profile, and leaderboard access -->
<div id="auth-container">
  <!-- Firebase DB connection status -->
  <div id="dbStatus" style="font-size:12px;color:#666;margin-right:8px">‚ö™ Offline</div>

  <!-- Signed-in user profile -->
  <!-- Hidden until Firebase auth fires; shows avatar + sign-out button -->
  <div id="user-profile" style="display:none">
    <img id="userPhoto" src="" alt="Profile">
    <span id="userName"></span>
    <button id="signOutBtn" style="margin-left:8px">Sign Out</button>
  </div>

  <!-- Sign-in button for Google -->
  <!-- Visible while no user session exists -->
  <div id="signin-container">
    <button id="googleSignInBtn">
      <img src="https://www.google.com/favicon.ico" width="14" height="14" style="margin-right:8px">
      Sign in with Google
    </button>
  </div>

  <!-- Local user management (hidden, Firebase-only) -->
  <select id="userSelect" title="Switch user" style="min-width:140px;display:none;"></select>
  <input id="newUserName" placeholder="New user..." style="display:none;" />
  <button id="addUserBtn" style="display:none;">Add</button>
  <button id="removeUserBtn" style="display:none;">Remove</button>

  <!-- Leaderboard access button -->
  <button id="showLeaderboardBtn">Leaderboard</button>
</div>


<!-- ===============================
     GAME AREA / BACKGROUND
     =============================== -->
<!-- Container for every animated element (truck, obstacles, parallax background) -->
<div class="loop-wrapper" id="loop-wrapper">

  <!-- Background elements for visual depth -->
  <!-- Repeat tree divs to stagger animation speeds for parallax effect -->
  <div class="mountain"></div>
  <div class="hill"></div>
  <div class="tree"></div>
  <div class="tree"></div>
  <div class="tree"></div>

  <!-- Container for dynamic obstacles spawned by JS -->
  <div id="obstacles-container"></div>

  <!-- Truck + wheels -->
  <div class="truck-wrapper" id="truck-wrapper">
    <div class="truck"></div>
    <div class="wheels"></div>
  </div>

  <!-- Score display -->
  <!-- The score text is updated every 200ms by script.js -->
  <div id="score">Score: 0</div>

  <!-- Overlay screen (shown at start or game over) -->
  <!-- JS toggles this overlay to show the start CTA or game-over stats -->
  <div id="overlay">
    <h1>Truck Runner</h1>
    <p>Dodge debris on the road!</p>
    <p style="font-size:12px;margin-top:-6px">Pick or create a user, each has separate saves.</p>
    <button id="startBtn">Start Game</button>
  </div>
</div>


<!-- ===============================
     LEADERBOARD MODAL
     =============================== -->
<!-- Modal sits outside the runner canvas so it can cover the whole viewport -->
<div id="leaderboardModal">
  <div class="modal-content">
    <h3>Leaderboard</h3>
    <!-- JS injects the top 10 Firestore scores here -->
    <div id="leaderboardList" style="max-height:220px;overflow:auto"></div>
    <div style="margin-top:8px;text-align:right">
      <button id="closeLeaderboardBtn" style="background:#888">Close</button>
    </div>
  </div>
</div>


<!-- ===============================
     BANANA PUZZLE MODAL
     =============================== -->
<!-- Second-life puzzle modal; triggered when the player crashes and still has a revive -->
<div id="bananaModal">
  <div class="modal-content">
    <h3>üçå Second Life Puzzle! üçå</h3>
    <p>Solve this math puzzle to continue playing:</p>
    <div id="bananaImageContainer">
      <img id="bananaImage" src="" alt="Math Puzzle" style="max-width:100%; height:auto; border:2px solid #4DB6AC; border-radius:8px;">
    </div>

    <div style="margin:16px 0;">
      <label for="bananaAnswer">Your Answer:</label>
      <input type="number" id="bananaAnswer" placeholder="Enter the answer..." style="margin-left:8px; padding:6px; border:1px solid #ddd; border-radius:4px;">
    </div>

    <div style="text-align:center;">
      <button id="submitBananaBtn" style="background:#4DB6AC; color:white; padding:8px 16px; border:none; border-radius:4px; cursor:pointer; margin-right:8px;">Submit Answer</button>
      <button id="skipBananaBtn" style="background:#888; color:white; padding:8px 16px; border:none; border-radius:4px; cursor:pointer;">Skip (Game Over)</button>
    </div>

    <div id="bananaStatus" style="margin-top:12px; text-align:center; font-weight:bold;"></div>
  </div>
</div>


<!-- ===============================
     MAIN SCRIPT
     =============================== -->
<!-- Main module wires Firebase auth, Firestore, banana puzzles, and runner logic -->
<script type="module" src="script.js"></script>

</body>
</html>
